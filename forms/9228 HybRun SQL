SELECT ArrayLabelling.ArrayRunNumber AS HybRun, Arrays.ArrayBarCode, ArrayLabelling.Subarray, Right([ArrayBarCode],3) & "." & [subarray] AS HybID, ArrayLabelledDNA.Code AS Cy3, ArrayLabelledDNA_1.Code AS Cy5, ArrayLabelledDNA.InternalPatientID AS Cy3IPI, ArrayLabelledDNA_1.InternalPatientID AS Cy5IPI, dbo_patient.lastname & " " & dbo_patient.firstname AS Cy3Name, dbo_patient_1.lastname & " " & dbo_patient_1.firstname AS Cy5Name, ArrayLabelledDNA.LabellingRunNo AS Cy3L, ArrayLabelledDNA_1.LabellingRunNo AS Cy5L, ArrayLabelledDNA.CleanupRunNo AS Cy3C, ArrayLabelledDNA_1.CleanupRunNo AS Cy5C, Referral.Referral AS Cy3Ref, Referral_1.Referral AS Cy5Ref
FROM ((((((((((ArrayLabelling INNER JOIN Arrays ON ArrayLabelling.ArrayID = Arrays.ArrayID) INNER JOIN ArrayLabelledDNA ON ArrayLabelling.Cy3ArrayLabelledDNAID = ArrayLabelledDNA.ArrayLabelledDNAID) INNER JOIN ArrayLabelledDNA AS ArrayLabelledDNA_1 ON ArrayLabelling.Cy5ArrayLabelledDNAID = ArrayLabelledDNA_1.ArrayLabelledDNAID) INNER JOIN Patients ON ArrayLabelledDNA.InternalPatientID = Patients.InternalPatientID) INNER JOIN dbo_Patient ON Patients.PatientID = dbo_Patient.PatientID) INNER JOIN Patients AS Patients_1 ON ArrayLabelledDNA_1.InternalPatientID = Patients_1.InternalPatientID) INNER JOIN dbo_Patient AS dbo_Patient_1 ON Patients_1.PatientID = dbo_Patient_1.PatientID) INNER JOIN ArrayTest ON (ArrayLabelling.DNALabellingID = ArrayTest.DNALabellingID) AND (Patients.InternalPatientID = ArrayTest.InternalPatientID)) INNER JOIN ArrayTest AS ArrayTest_1 ON (Patients_1.InternalPatientID = ArrayTest_1.InternalPatientID) AND (ArrayLabelling.DNALabellingID = ArrayTest_1.DNALabellingID)) INNER JOIN Referral ON ArrayTest.ReferralID = Referral.ReferralID) INNER JOIN Referral AS Referral_1 ON ArrayTest_1.ReferralID = Referral_1.ReferralID
WHERE (((ArrayLabelling.ArrayRunNumber)=[Hyb run number?]))
ORDER BY Arrays.ArrayBarCode, ArrayLabelling.Subarray;
