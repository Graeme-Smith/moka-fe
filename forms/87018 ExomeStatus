Private Sub AllInProgress_Click()
    'Set subform RecordSet to retrieve all in progress WES tests
    sqlInProgress = "SELECT ExomeTest.ExomeTestID, Patients.PatientID, Patients.BookinLastName, Patients.BookinFirstName, Patients.BookinDOB, Patients.BookinSex, Referral.Referral, Format([ExomeTest.RequestedDate],'dd-mmm-yy') AS RequestDate, Status.StatusID, Status.Status, Checker.Initials, NGSPanel.Panel AS PanelA, NGSPanel_1.Panel AS PanelB " & _
    "FROM (((Referral INNER JOIN ((ExomeTest INNER JOIN Patients ON ExomeTest.InternalPatientID = Patients.InternalPatientID) INNER JOIN Checker ON ExomeTest.BookedByID = Checker.Check1ID) ON Referral.ReferralID = ExomeTest.ReferralID) INNER JOIN Status ON ExomeTest.StatusID = Status.StatusID) INNER JOIN NGSPanel ON ExomeTest.NGSPanelID_A = NGSPanel.NGSPanelID) INNER JOIN NGSPanel AS NGSPanel_1 ON ExomeTest.NGSPanelID_B = NGSPanel_1.NGSPanelID " & _
    "WHERE (((Status.StatusID)<>4 And (Status.StatusID)<>5)) " & _
    "ORDER BY ExomeTest.RequestedDate;"
    Me![SubExomeStatus].Form.RecordSource = sqlInProgress
    Me![SubExomeStatus].SetFocus
End Sub

Private Sub Close_Click()
    DoCmd.Close
End Sub

Private Sub Search_Click()
    'Set subform RecordSet to retrieve all WES tests that match PRU number
    If Not IsNull(Me![PatPRU]) Then
        sqlSearchPatient = "SELECT ExomeTest.ExomeTestID, Patients.PatientID, Patients.BookinLastName, Patients.BookinFirstName, Patients.BookinDOB, Patients.BookinSex, Referral.Referral, Format([ExomeTest.RequestedDate],'dd-mmm-yy') AS RequestDate, Status.StatusID, Status.Status, Checker.Initials, NGSPanel.Panel AS PanelA, NGSPanel_1.Panel AS PanelB " & _
        "FROM (((Referral INNER JOIN ((ExomeTest INNER JOIN Patients ON ExomeTest.InternalPatientID = Patients.InternalPatientID) INNER JOIN Checker ON ExomeTest.BookedByID = Checker.Check1ID) ON Referral.ReferralID = ExomeTest.ReferralID) INNER JOIN Status ON ExomeTest.StatusID = Status.StatusID) INNER JOIN NGSPanel ON ExomeTest.NGSPanelID_A = NGSPanel.NGSPanelID) INNER JOIN NGSPanel AS NGSPanel_1 ON ExomeTest.NGSPanelID_B = NGSPanel_1.NGSPanelID " & _
        "WHERE (((Patients.PatientID) Like [Forms]![ExomeStatus].[PatPRU] & '*')) " & _
        "ORDER BY ExomeTest.RequestedDate;"
        Me![SubExomeStatus].Form.RecordSource = sqlSearchPatient
        Me![SubExomeStatus].SetFocus
    End If
End Sub
