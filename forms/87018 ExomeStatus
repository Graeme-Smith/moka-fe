Private Sub Form_Load()
    'So doesnt show records on form open
    Dim sqlInProgress As String
    sqlInProgress = "SELECT NULL AS NGSTestID, NULL AS PatientID, NULL AS BookinLastName, NULL AS BookinFirstName, NULL AS BookinDOB, NULL AS BookinSex, NULL AS Referral, NULL AS DateRequested, NULL AS StatusID, Null AS Status, Null AS RefName, Null AS PanelA, Null AS PanelB;"
    [Form_s87018_ExomeStatus].RecordSource = sqlInProgress
End Sub

Private Sub AllInProgress_Click()
    Dim sqlInProgress As String
    'Set subform RecordSet to retrieve all in progress WES tests
    sqlInProgress = "SELECT NGSTest.NGSTestID, Patients.PatientID, Patients.BookinLastName, Patients.BookinFirstName, Patients.BookinDOB, Patients.BookinSex, Referral.Referral, NGSTest.DateRequested, Status.StatusID, Status.Status, Checker.Name As RefName, NGSPanel.Panel AS PanelA, NGSPanel_1.Panel AS PanelB " & _
    "FROM (((Referral INNER JOIN ((NGSTest INNER JOIN Patients ON NGSTest.InternalPatientID = Patients.InternalPatientID) INNER JOIN Checker ON NGSTest.BookBy = Checker.Check1ID) ON Referral.ReferralID = NGSTest.ReferralID) INNER JOIN Status ON NGSTest.StatusID = Status.StatusID) INNER JOIN NGSPanel ON NGSTest.NGSPanelID = NGSPanel.NGSPanelID) LEFT JOIN NGSPanel AS NGSPanel_1 ON NGSTest.NGSPanelID_B = NGSPanel_1.NGSPanelID " & _
    "WHERE Status.StatusID <> 4 And Status.StatusID <> 5 And Status.StatusID <> 1202218787 " & _
    "ORDER BY NGSTest.DateRequested;"
    [Form_s87018_ExomeStatus].Form.RecordSource = sqlInProgress
    '[Form_s87018_ExomeStatus].SetFocus
End Sub


Private Sub Close_Click()
    DoCmd.Close
End Sub

Private Sub Search_Click()
    Dim sqlInProgress As String
    'Set subform RecordSet to retrieve all WES tests that match PRU number
    If Not IsNull(Me![PatPRU]) Then
        sqlSearchPatient = "SELECT NGSTest.NGSTestID, Patients.PatientID, Patients.BookinLastName, Patients.BookinFirstName, Patients.BookinDOB, Patients.BookinSex, Referral.Referral, NGSTest.DateRequested, Status.StatusID, Status.Status, Checker.Name As RefName, NGSPanel.Panel AS PanelA, NGSPanel_1.Panel AS PanelB " & _
        "FROM (((Referral INNER JOIN ((NGSTest INNER JOIN Patients ON NGSTest.InternalPatientID = Patients.InternalPatientID) INNER JOIN Checker ON NGSTest.BookBy = Checker.Check1ID) ON Referral.ReferralID = NGSTest.ReferralID) INNER JOIN Status ON NGSTest.StatusID = Status.StatusID) INNER JOIN NGSPanel ON NGSTest.NGSPanelID = NGSPanel.NGSPanelID) LEFT JOIN NGSPanel AS NGSPanel_1 ON NGSTest.NGSPanelID_B = NGSPanel_1.NGSPanelID " & _
        "WHERE (((Patients.PatientID) Like [Forms]![87018 ExomeStatus].[PatPRU] & '*')) " & _
        "ORDER BY NGSTest.DateRequested;"
        [Form_s87018_ExomeStatus].Form.RecordSource = sqlSearchPatient
        '[Form_s87018_ExomeStatus].SetFocus
    End If
End Sub
