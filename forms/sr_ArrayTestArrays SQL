SELECT Left([patients].[patientid],6) AS FamilyNo, Patients.InternalPatientID, Patients.PatientID, ArrayTest.RequestedDate, ArrayTest.StatusID, Format([ArrayTest].[RequestedDate],"DD/MM/YYYY") & ": " & [referral].[referral] & " array requested for " & [arraytest].[specimenno] & " " & [dbo_Patient_Table].[LastName] & " " & [dbo_Patient_Table].[FirstName] & " (" & [Patients].[PatientID] & ", DoB " & [dbo_Patient_Table].[DoB] & ")" AS Requesting, ArrayTest.ArrayResult, ArrayTest.ArrayResultComment, "Result entered by " & Checker.Initials & " (" & Left(ArrayTest.Check1Date,10) & ")" AS [By], "Result checked by " & Checker_1.Initials & " (" & Left([ArrayResultDate],10) & ")" AS By2, " DesignID " & [s_HybIDs_DesignID].[DesignID] & " / " & [s_HybIDs_DesignID].[HybID] AS DesignID, "Results mapped to build " & [Item] AS Build, ArrayTest.ArrayTestID
FROM ((((((Patients INNER JOIN ArrayTest ON Patients.InternalPatientID = ArrayTest.InternalPatientID) INNER JOIN Referral ON ArrayTest.ReferralID = Referral.ReferralID) LEFT JOIN Checker ON ArrayTest.Check1ID = Checker.Check1ID) LEFT JOIN Checker AS Checker_1 ON ArrayTest.Check2ID = Checker_1.Check1ID) LEFT JOIN Item ON ArrayTest.ArrayResultBuild = Item.ItemID) LEFT JOIN s_HybIDs_DesignID ON (ArrayTest.InternalPatientID = s_HybIDs_DesignID.InternalPatientID) AND (ArrayTest.DNALabellingID = s_HybIDs_DesignID.DNALabellingID)) INNER JOIN dbo_Patient_Table ON Patients.PatientID = dbo_Patient_Table.PatientTrustID
WHERE (((Left([patients].[patientid],6))=[Reports]![ArrayTestSheet]![FamilyNo]) AND ((ArrayTest.StatusID)<>1202218787) AND ((ArrayTest.ArrayTestID)<>[Reports]![ArrayTestSheet]![ArrayTestID]))
ORDER BY Patients.PatientID, ArrayTest.RequestedDate;
