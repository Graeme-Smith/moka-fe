SELECT Left([patients].[patientid],6) AS FamilyNo, Patients.InternalPatientID, Patients.PatientID, ArrayTest.RequestedDate, ArrayTest.StatusID, Format([ArrayTest].[RequestedDate],"DD/MM/YYYY") & ": " & [referral].[referral] & " array requested for " & [dbo_Patient_Table].[LastName] & " " & [dbo_Patient_Table].[FirstName] & " (DoB " & [dbo_Patient_Table].[DoB] & ")" AS Requesting, ArrayTest.ArrayResult, "DesignID " & [s_HybIDs_DesignID].[DesignID] & " / " & [s_HybIDs_DesignID].[HybID] AS DesignID, "Results mapped to build " & [Item] AS Build, ArrayTest.ArrayTestID
FROM ((((Patients INNER JOIN ArrayTest ON Patients.InternalPatientID = ArrayTest.InternalPatientID) INNER JOIN Referral ON ArrayTest.ReferralID = Referral.ReferralID) INNER JOIN Item ON ArrayTest.ArrayResultBuild = Item.ItemID) LEFT JOIN s_HybIDs_DesignID ON (ArrayTest.DNALabellingID = s_HybIDs_DesignID.DNALabellingID) AND (ArrayTest.InternalPatientID = s_HybIDs_DesignID.InternalPatientID)) INNER JOIN dbo_Patient_Table ON Patients.PatientID = dbo_Patient_Table.PatientTrustID
WHERE (((ArrayTest.StatusID)<>1202218787) AND ((ArrayTest.ArrayTestID)<>[Reports]![ArrayTestSheet]![ArrayTestID]))
ORDER BY Patients.PatientID, ArrayTest.RequestedDate;
