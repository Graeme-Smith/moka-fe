Option Compare Database

Private Sub blockautoreport_AfterUpdate()
    Dim dt As String
    Dim un As String
    Dim cn As String
    Dim blockStatus As String
    ' set date, username and computer name as required by log tables
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    un = VBA.Environ("USERNAME")
    cn = VBA.Environ("COMPUTERNAME")
    
    If Me.BlockAutomatedReporting <> 0 Then
        blockStatus = "blocked"
    Else
        blockStatus = "unblocked"
    End If
    
    'SQL statement for PatientLog
    sqlPatLog = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID.Value) + ",'GEL NGS Test: Automated reporting " + blockStatus & _
    "',#" + dt + "#,'" + un + "','" + cn + "')"
    
    'Execute SQL statements
    DoCmd.SetWarnings False
    DoCmd.RunSQL sqlPatLog
    DoCmd.SetWarnings True
End Sub

Private Sub BookBy_AfterUpdate()
    Dim dt As String
    Dim un As String
    Dim cn As String
    ' set date, username and computer name as required by log tables
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    un = VBA.Environ("USERNAME")
    cn = VBA.Environ("COMPUTERNAME")
    
    
    'SQL statement for NGSLogMemo
    sqlMemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID.Value) + ", 3, " + CStr(Me.NGSTestID) & _
    ",'GEL NGS Test: referring clinician updated to " + Me.BookBy.Column(1) + " ',#" + dt + "#,'" + un + "','" + cn + "')"
    'SQL statement for PatientLog
    sqlPatLog = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID.Value) + ",'GEL NGS Test: referring clinician updated to " + Me.BookBy.Column(1) & _
    "',#" + dt + "#,'" + un + "','" + cn + "')"
    
    'Execute SQL statements
    DoCmd.SetWarnings False
    DoCmd.RunSQL sqlPatLog
    DoCmd.RunSQL sqlMemo
    DoCmd.SetWarnings True

End Sub

Private Sub GELProbandID_AfterUpdate()
    Dim dt As String
    Dim un As String
    Dim cn As String
    ' set date, username and computer name as required by log tables
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    un = VBA.Environ("USERNAME")
    cn = VBA.Environ("COMPUTERNAME")
    
    'SQL statement for NGSLogMemo
    sqlMemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ", 3, " + CStr(Me.NGSTestID) & _
    ",'GEL NGS Test: GELProbandID updated to " + CStr(Me.GELProbandID) + " ',#" + dt + "#,'" + un + "','" + cn + "')"
    'SQL statement for PatientLog
    sqlPatLog = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ",'GEL NGS Test: GELProbandID updated to " + CStr(Me.GELProbandID) & _
    "',#" + dt + "#,'" + un + "','" + cn + "')"
    
    'Execute SQL statements
    DoCmd.SetWarnings False
    DoCmd.RunSQL sqlPatLog
    DoCmd.RunSQL sqlMemo
    DoCmd.SetWarnings True
End Sub
Private Sub IRID_AfterUpdate()
    Dim dt As String
    Dim un As String
    Dim cn As String
    ' set date, username and computer name as required by log tables
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    un = VBA.Environ("USERNAME")
    cn = VBA.Environ("COMPUTERNAME")
    
    'SQL statement for NGSLogMemo
    sqlMemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ", 3, " + CStr(Me.NGSTestID) & _
    ",'GEL NGS Test: IR-ID updated to " + CStr(Me.IRID) + " ',#" + dt + "#,'" + un + "','" + cn + "')"
    'SQL statement for PatientLog
    sqlPatLog = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ",'GEL NGS Test: IR-ID updated to " + CStr(Me.IRID) & _
    "',#" + dt + "#,'" + un + "','" + cn + "')"
    
    'Execute SQL statements
    DoCmd.SetWarnings False
    DoCmd.RunSQL sqlPatLog
    DoCmd.RunSQL sqlMemo
    DoCmd.SetWarnings True

End Sub

Private Sub Name_DblClick(Cancel As Integer)
    ' Open the patient details form when double click on Name
    Dim stDocName As String
    Dim stLinkCriteria As String
    ' define the name of the form to open
    stDocName = "02 Patient Details"
    ' Use the internalpatientID to link forms
    stLinkCriteria = "[InternalPatientID]=" & Me![InternalPatientID]
    ' open the form using linking criteria defined above
    DoCmd.OpenForm stDocName, , , stLinkCriteria
End Sub
