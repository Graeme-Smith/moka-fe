Option Compare Database

Private Sub BookBy_AfterUpdate()
    Dim dt As String
    Dim un As String
    Dim cn As String
    ' set date, username and computer name as required by log tables
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    un = VBA.Environ("USERNAME")
    cn = VBA.Environ("COMPUTERNAME")
    
    'SQL statement for NGSLogMemo
    sqlMemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ", 3, " + CStr(Me.NGSTestID) & _
    ",'GEL NGS Test: referring clinician updated to " + CStr(Me.BookBy) + " ',#" + dt + "#,'" + un + "','" + cn + "')"
    'SQL statement for PatientLog
    sqlPatLog = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ",'GEL NGS Test: referring clinician updated to " + Me.BookBy.Column(1) & _
    "',#" + dt + "#,'" + un + "','" + cn + "')"
    
    'Execute SQL statements
    DoCmd.SetWarnings False
    DoCmd.RunSQL sqlPatLog
    DoCmd.RunSQL sqlMemo
    DoCmd.SetWarnings True

End Sub

'Private Sub Check1ID_Change()
'    Dim usr As String
'    Dim dt As String
'    Dim cmp As String
'    Dim strPatLogTest As String
'    Dim strmemo As String
'
'    ' set time, user and computer names for logs
'    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
'    usr = VBA.Environ("USERNAME")
'    cmp = VBA.Environ("COMPUTERNAME")
'    ' create sql to insert into patient log and NGS log
'    strPatLogTest = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 'NGS: GeL responsible scientist changed to " & Me.Check1ID.Column(1) & ".',#" + dt + "#,'" + usr + "','" + cmp + "')"
'    strmemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 3, " & Me.NGSTestID & ",'NGS: GeL responsible scientist changed to " & Me.Check1ID.Column(1) & ".',#" + dt + "#,'" + usr + "','" + cmp + "')"
'
'    DoCmd.SetWarnings False
'    DoCmd.RunSQL strPatLogTest
'    DoCmd.RunSQL strmemo
'    DoCmd.SetWarnings True
'End Sub


Private Sub GELProbandID_AfterUpdate()
    Dim dt As String
    Dim un As String
    Dim cn As String
    ' set date, username and computer name as required by log tables
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    un = VBA.Environ("USERNAME")
    cn = VBA.Environ("COMPUTERNAME")
    
    'SQL statement for NGSLogMemo
    sqlMemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ", 3, " + CStr(Me.NGSTestID) & _
    ",'GEL NGS Test: GELProbandID updated to " + CStr(Me.GELProbandID) + " ',#" + dt + "#,'" + un + "','" + cn + "')"
    'SQL statement for PatientLog
    sqlPatLog = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ",'GEL NGS Test: GELProbandID updated to " + CStr(Me.GELProbandID) & _
    "',#" + dt + "#,'" + un + "','" + cn + "')"
    
    'Execute SQL statements
    DoCmd.SetWarnings False
    DoCmd.RunSQL sqlPatLog
    DoCmd.RunSQL sqlMemo
    DoCmd.SetWarnings True
End Sub
Private Sub IRID_AfterUpdate()
    Dim dt As String
    Dim un As String
    Dim cn As String
    ' set date, username and computer name as required by log tables
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    un = VBA.Environ("USERNAME")
    cn = VBA.Environ("COMPUTERNAME")
    
    'SQL statement for NGSLogMemo
    sqlMemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ", 3, " + CStr(Me.NGSTestID) & _
    ",'GEL NGS Test: IR-ID updated to " + CStr(Me.IRID) + " ',#" + dt + "#,'" + un + "','" + cn + "')"
    'SQL statement for PatientLog
    sqlPatLog = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" + CStr(Me.InternalPatientID) + ",'GEL NGS Test: IR-ID updated to " + CStr(Me.IRID) & _
    "',#" + dt + "#,'" + un + "','" + cn + "')"
    
    'Execute SQL statements
    DoCmd.SetWarnings False
    DoCmd.RunSQL sqlPatLog
    DoCmd.RunSQL sqlMemo
    DoCmd.SetWarnings True

End Sub
