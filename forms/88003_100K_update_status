Option Compare Database


Private Sub Check1ID_Change()
    Dim usr As String
    Dim dt As String
    Dim cmp As String
    Dim strPatLogTest As String
    Dim strmemo As String
        
    ' set time, user and computer names for logs
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    usr = VBA.Environ("USERNAME")
    cmp = VBA.Environ("COMPUTERNAME")
    ' create sql to insert into patient log and NGS log
    strPatLogTest = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 'NGS: GeL responsible scientist changed to " & Me.Check1ID.Column(1) & ".',#" + dt + "#,'" + usr + "','" + cmp + "')"
    strmemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 3, " & Me.NGSTestID & ",'NGS: GeL responsible scientist changed to " & Me.Check1ID.Column(1) & ".',#" + dt + "#,'" + usr + "','" + cmp + "')"
    
    DoCmd.SetWarnings False
    DoCmd.RunSQL strPatLogTest
    DoCmd.RunSQL strmemo
    DoCmd.SetWarnings True
End Sub

Private Sub MDTdate_BeforeUpdate(Cancel As Integer)
    Dim usr As String
    Dim dt As String
    Dim cmp As String
    Dim strPatLogTest As String
    Dim strmemo As String
        
    ' set time, user and computer names for logs
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    usr = VBA.Environ("USERNAME")
    cmp = VBA.Environ("COMPUTERNAME")
    ' create sql to insert into patient log and NGS log
    strPatLogTest = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 'NGS: MDT date changed to " & Me.MDTdate & ".',#" + dt + "#,'" + usr + "','" + cmp + "')"
    strmemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 3, " & Me.NGSTestID & ",'NGS: MDT date changed to " & Me.MDTdate & ".',#" + dt + "#,'" + usr + "','" + cmp + "')"
    Debug.Print strmemo
    DoCmd.SetWarnings False
    DoCmd.RunSQL strPatLogTest
    DoCmd.RunSQL strmemo
    DoCmd.SetWarnings True
End Sub


Private Sub ResultComment_Change()
    Dim usr As String
    Dim dt As String
    Dim cmp As String
    Dim strPatLogTest As String
    Dim strmemo As String
        
    ' set time, user and computer names for logs
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    usr = VBA.Environ("USERNAME")
    cmp = VBA.Environ("COMPUTERNAME")
    ' create sql to insert into patient log and NGS logstrPatLogTest = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 'NGS: GeL result comment changed to " & Me.ResultComment & ".',#" + dt + "#,'" + usr + "','" + cmp + "')"
    strmemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 3, " & Me.NGSTestID & ",'NGS: GeL result comment changed to " & Me.ResultComment & ",#" + dt + "#,'" + usr + "','" + cmp + "')"
    DoCmd.SetWarnings False
    DoCmd.RunSQL strPatLogTest
    DoCmd.RunSQL strmemo
    DoCmd.SetWarnings True
End Sub

Private Sub Status_Change()
    Dim usr As String
    Dim dt As String
    Dim cmp As String
    Dim strPatLogTest As String
    Dim strmemo As String
        
    ' set time, user and computer names for logs
    dt = Format(Now, "dd/mmm/yyyy Hh:Nn:ss")
    usr = VBA.Environ("USERNAME")
    cmp = VBA.Environ("COMPUTERNAME")
    ' create sql to insert into patient log and NGS log
    strPatLogTest = "INSERT INTO PatientLog(InternalPatientID, LogEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 'NGS: GeL test status changed to " & Me.Status.Column(1) & ".',#" + dt + "#,'" + usr + "','" + cmp + "')"
    strmemo = "INSERT INTO NGSLogMemo(InternalPatientID, Type, LinkID, LogMemoEntry, [Date], Login, PCName) VALUES(" & Me.InternalPatientID & ", 3, " & Me.NGSTestID & ",'NGS: GeL test status changed to " & Me.Status.Column(1) & ".' ,#" + dt + "#,'" + usr + "','" + cmp + "')"
    DoCmd.SetWarnings False
    DoCmd.RunSQL strPatLogTest
    DoCmd.RunSQL strmemo
    DoCmd.SetWarnings True
End Sub


