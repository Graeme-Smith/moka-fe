SELECT s_ArraysForAnalysis_HybAndLabellingIDsHybRun.ArrayRunNumber, Right([ArrayBarCode],3) & "." & [Subarray] & " (" & ArrayLabelling.ArrayRunNumber & ")" AS HybID, FailCount.Fail, Referral.Referral, [LastName] & " " & [FirstName] AS Name, Status.Status, ArrayTest.InternalPatientID, ArrayTest.StatusID, Arrays.ArrayBarCode, ArrayLabelling.Subarray, ArrayLabelledDNA.ArrayLabelID
FROM ((ArrayLabelling INNER JOIN ((s_ArraysForAnalysis_HybAndLabellingIDsHybRun INNER JOIN ArrayLabelledDNA ON s_ArraysForAnalysis_HybAndLabellingIDsHybRun.ArrayLabelledDNAID = ArrayLabelledDNA.ArrayLabelledDNAID) INNER JOIN ((((ArrayTest INNER JOIN Status ON ArrayTest.StatusID = Status.StatusID) INNER JOIN Patients ON ArrayTest.InternalPatientID = Patients.InternalPatientID) INNER JOIN dbo_Patient ON Patients.PatientID = dbo_Patient.PatientID) INNER JOIN Referral ON ArrayTest.ReferralID = Referral.ReferralID) ON ArrayLabelledDNA.InternalPatientID = ArrayTest.InternalPatientID) ON ArrayLabelling.DNALabellingID = s_ArraysForAnalysis_HybAndLabellingIDsHybRun.DNALabellingID) INNER JOIN Arrays ON ArrayLabelling.ArrayID = Arrays.ArrayID) LEFT JOIN FailCount ON ArrayLabelling.FailCountID = FailCount.FailCountID
WHERE (((s_ArraysForAnalysis_HybAndLabellingIDsHybRun.ArrayRunNumber)=[Hyb run?]) AND ((ArrayTest.StatusID)<>4 And (ArrayTest.StatusID)<>5 And (ArrayTest.StatusID)<>1202218787 And (ArrayTest.StatusID)<>1168443127 And (ArrayTest.StatusID)<>1168443128 And (ArrayTest.StatusID)<>1202218794))
ORDER BY Arrays.ArrayBarCode, ArrayLabelling.Subarray, ArrayLabelledDNA.ArrayLabelID;
