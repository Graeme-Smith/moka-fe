SELECT TOP 24 Format([DateAuthorized],"yyyy") & "-" & Format(Format([DateAuthorized],"mm"),"00") AS [Month], Count(ArrayTest.ArrayTestID) AS CountOfArrayTestID, Sum(IIf(DateDiff("d",[dbo_Specimen_Table].[DateReceived],[dbo_SpecimenReportLinked].[DateAuthorized])<14,1,0)) AS Count14days, Sum(IIf(DateDiff("d",[dbo_Specimen_Table].[DateReceived],[dbo_SpecimenReportLinked].[DateAuthorized])<14,1,0))/Count([arraytestid]) AS 14days, Avg(DateDiff("d",[dbo_Specimen_Table].[DateReceived],[dbo_SpecimenReportLinked].[DateAuthorized])) AS TATMeanAll, StDev(DateDiff("d",[dbo_Specimen_Table].[DateReceived],[dbo_SpecimenReportLinked].[DateAuthorized]))/Avg(DateDiff("d",[dbo_Specimen_Table].[DateReceived],[dbo_SpecimenReportLinked].[DateAuthorized])) AS CV
FROM (ArrayTest INNER JOIN Checker ON ArrayTest.Check2ID = Checker.Check1ID) INNER JOIN (dbo_SpecimenReportLinked INNER JOIN dbo_Specimen_Table ON dbo_SpecimenReportLinked.SpecimenID = dbo_Specimen_Table.SpecimenID) ON ArrayTest.SpecimenNo = dbo_Specimen_Table.SpecimenTrustID
WHERE (((ArrayTest.ReferralID)=2 Or (ArrayTest.ReferralID)=1199901192 Or (ArrayTest.ReferralID)=1199901183) AND ((ArrayTest.Priority)=True) AND ((dbo_SpecimenReportLinked.Description)="7a - aCGH general - Viapath") AND ((DateDiff("d",[dbo_Specimen_Table].[DateReceived],[dbo_SpecimenReportLinked].[DateAuthorized]))<100))
GROUP BY Format([DateAuthorized],"yyyy") & "-" & Format(Format([DateAuthorized],"mm"),"00")
ORDER BY Format([DateAuthorized],"yyyy") & "-" & Format(Format([DateAuthorized],"mm"),"00") DESC;
