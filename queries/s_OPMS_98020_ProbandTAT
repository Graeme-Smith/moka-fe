SELECT TOP 24 Format([dbo_specimenreportlinked].[DateAuthorized],"yyyy") & "-" & Format(Format([dbo_specimenreportlinked].[DateAuthorized],"mm"),"00") AS [Month], Count(ArrayTest.ArrayTestID) AS CountOfArrayTestID, Sum(IIf(DateDiff("d",[dbo_specimenlinked].[DateReceived],[dbo_specimenreportlinked].[DateAuthorized])<28,1,0)) AS Count28days, Sum(IIf(DateDiff("d",[dbo_specimenlinked].[DateReceived],[dbo_specimenreportlinked].[DateAuthorized])<28,1,0))/Count([arraytestid]) AS 28days, Avg(DateDiff("d",[dbo_specimenlinked].[DateReceived],[dbo_specimenreportlinked].[DateAuthorized])) AS TATMeanAll, StDev(DateDiff("d",[dbo_specimenlinked].[DateReceived],[dbo_specimenreportlinked].[DateAuthorized]))/Avg(DateDiff("d",[dbo_specimenlinked].[DateReceived],[dbo_specimenreportlinked].[DateAuthorized])) AS CV
FROM ArrayTest INNER JOIN (dbo_SpecimenReportLinked INNER JOIN dbo_specimenlinked ON dbo_SpecimenReportLinked.SpecimenID = dbo_specimenlinked.SpecimenID) ON ArrayTest.SpecimenNo = dbo_specimenlinked.SpecimenTrustID
WHERE (((ArrayTest.ReferralID)=2 Or (ArrayTest.ReferralID)=1199901192 Or (ArrayTest.ReferralID)=1199901183 Or (ArrayTest.ReferralID)=1199901169 Or (ArrayTest.ReferralID)=1199901181 Or (ArrayTest.ReferralID)=11999011942 Or (ArrayTest.ReferralID)=1199901192 Or (ArrayTest.ReferralID)=1199901183 Or (ArrayTest.ReferralID)=1199901169 Or (ArrayTest.ReferralID)=1199901181 Or (ArrayTest.ReferralID)=1199901194) AND ((ArrayTest.Priority)=False) AND ((dbo_SpecimenReportLinked.Description)="7a - aCGH general - Viapath" Or (dbo_SpecimenReportLinked.Description)="7i - aCGH general ISCAv2 - Viapath" Or (dbo_SpecimenReportLinked.Description)="10-aCGH General New") AND ((ArrayTest.StatusID)=4) AND ((ArrayTest.Service)=True))
GROUP BY Format([dbo_specimenreportlinked].[DateAuthorized],"yyyy") & "-" & Format(Format([dbo_specimenreportlinked].[DateAuthorized],"mm"),"00")
ORDER BY Format([dbo_specimenreportlinked].[DateAuthorized],"yyyy") & "-" & Format(Format([dbo_specimenreportlinked].[DateAuthorized],"mm"),"00") DESC;
